<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>testament</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);

  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark') {
      toggleSwitch.checked = true;
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">testament</h1>
    Testament is an advanced automatic unittests runner for Nim tests, is used for the development of Nim itself, offers process isolation for your tests, it can generate statistics about test cases, supports multiple targets (C, C++, ObjectiveC, JavaScript, etc), simulated <a class="reference external" href="https://en.wikipedia.org/wiki/Dry_run_(testing)">Dry-Runs</a>, has logging, can generate HTML reports, skip tests from a file and more, so can be useful to run your tests, even the most complex ones.
<h1 id="test-files-location">Test files location</h1><p>By default Testament looks for test files on <tt class="docutils literal"><span class="pre">&quot;./tests/*.nim&quot;</span></tt>, you can overwrite this pattern glob using <tt class="docutils literal"><span class="pre">pattern &lt;glob&gt;</span></tt>, the default working directory path can be changed using <tt class="docutils literal"><span class="pre">--directory:&quot;folder/subfolder/&quot;</span></tt>.</p>
<p>Testament uses the nim compiler on <tt class="docutils literal"><span class="pre">PATH</span></tt> you can change that using <tt class="docutils literal"><span class="pre">--nim:&quot;folder/subfolder/nim&quot;</span></tt>, running JavaScript tests with <tt class="docutils literal"><span class="pre">--targets:&quot;js&quot;</span></tt> requires a working NodeJS on <tt class="docutils literal"><span class="pre">PATH</span></tt>.</p>

<h1 id="options">Options</h1><ul class="simple"><li><tt class="docutils literal"><span class="pre">--print</span></tt>                   Also print results to the console</li>
<li><tt class="docutils literal"><span class="pre">--simulate</span></tt>                See what tests would be run but don't run them (for debugging)</li>
<li><tt class="docutils literal"><span class="pre">--failing</span></tt>                 Only show failing/ignored tests</li>
<li><tt class="docutils literal"><span class="pre">--targets:&quot;c c++ js objc&quot;</span></tt> Run tests for specified targets (default: all)</li>
<li><tt class="docutils literal"><span class="pre">--nim:path</span></tt>                Use a particular nim executable (default: <tt class="docutils literal"><span class="pre">$PATH/nim</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">--directory:dir</span></tt>           Change to directory dir before reading the tests or doing anything else.</li>
<li><tt class="docutils literal"><span class="pre">--colors:on|off</span></tt>           Turn messages coloring on|off.</li>
<li><tt class="docutils literal"><span class="pre">--backendLogging:on|off</span></tt>   Disable or enable backend logging. By default turned on.</li>
<li><tt class="docutils literal"><span class="pre">--skipFrom:file</span></tt>           Read tests to skip from <tt class="docutils literal"><span class="pre">file</span></tt> - one test per line, # comments ignored</li>
</ul>

<h1 id="running-a-single-test">Running a single test</h1><p>This is a minimal example to understand the basics, not very useful for production, but easy to understand:</p>
<pre class="listing">
$ mkdir tests
$ echo &quot;assert 42 == 42&quot; &gt; tests/test0.nim
$ testament run test0.nim
  PASS: tests/test0.nim C                                       ( 0.2 sec)

$ testament r test0
  PASS: tests/test0.nim C                                       ( 0.2 sec)

$</pre>
<h1 id="running-all-tests-from-a-directory">Running all tests from a directory</h1><pre class="listing">
$ testament pattern &quot;tests/*.nim&quot;</pre>
<h1 id="html-reports">HTML Reports</h1><p>Generate HTML Reports <tt class="docutils literal"><span class="pre">testresults.html</span></tt> from unittests, you have to run at least 1 test <em>before</em> generating a report:</p>
<pre class="listing">
$ testament html</pre>
<h1 id="writing-unitests">Writing Unitests</h1><p>Example &quot;template&quot; <strong>to edit</strong> and write a Testament unittest:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  
  action: &quot;run&quot;     # What to do, one of &quot;compile&quot; OR &quot;run&quot;.
  
  exitcode: 0       # This is the Exit Code the test should return, zero typically.
  
  output: &quot;&quot;        # This is the Standard Output the test should print, if any.
  
  input:  &quot;&quot;        # This is the Standard Input the test should take, if any.
  
  errormsg: &quot;&quot;      # Error message the test should print, if any.
  
  batchable: true   # Can be run in batch mode, or not.
  
  joinable: true    # Can be run Joined with other tests to run all togheter, or not.
  
  valgrind: false   # Can use Valgrind to check for memory leaks, or not (Linux 64Bit only).
  
  cmd: &quot;nim c -r $file&quot; # Command the test should use to run.
  
  maxcodesize: 666  # Maximum generated temporary intermediate code file size for the test.
  
  timeout: 666      # Timeout microseconds to run the test.
  
  target: &quot;c js&quot;    # Targets to run the test into (C, C++, JavaScript, etc).
  
  disabled: &quot;bsd&quot;   # Disable the test by condition, here BSD is disabled just as an example.
  disabled: &quot;win&quot;   # Can disable multiple OSes at once
  disabled: &quot;32bit&quot; # ...or architectures
  disabled: &quot;i386&quot;
  disabled: &quot;azure&quot; # ...or pipeline runners
  disabled: true    # ...or can disable the test entirely

&quot;&quot;&quot;</span>
<span class="Identifier">assert</span> <span class="Identifier">true</span>
<span class="Identifier">assert</span> <span class="DecNumber">42</span> <span class="Operator">==</span> <span class="DecNumber">42</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Assert error message&quot;</span></pre><ul class="simple"><li>As you can see the &quot;Spec&quot; is just a <tt class="docutils literal"><span class="pre">discard &quot;&quot;&quot; &quot;&quot;&quot;</span></tt>.</li>
<li>Spec has sane defaults, so you dont need to provide them all, any simple assert will work Ok.</li>
<li><a class="reference external" href="https://github.com/nim-lang/Nim/blob/devel/testament/specs.nim#L238">This is not the full spec of Testament, check the Testament Spec on GitHub, see parseSpec().</a></li>
<li><a class="reference external" href="https://github.com/nim-lang/Nim/tree/devel/tests">Nim itself uses Testament, so theres plenty of test examples.</a></li>
<li>Has some built-in CI compatibility, like Azure Pipelines, etc.</li>
<li><a class="reference external" href="https://github.com/nim-lang/Nim/blob/9a110047cbe2826b1d4afe63e3a1f5a08422b73f/tests/effects/teffects1.nim">Testament supports inlined error messages on Unittests, basically comments with the expected error directly on the code.</a></li>
</ul>

<h1 id="unitests-examples">Unitests Examples</h1><p>Expected to fail:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  errormsg: &quot;undeclared identifier: 'not_defined'&quot;
&quot;&quot;&quot;</span>
<span class="Identifier">assert</span> <span class="Identifier">not_defined</span> <span class="Operator">==</span> <span class="StringLit">&quot;not_defined&quot;</span><span class="Punctuation">,</span> <span class="StringLit">&quot;not_defined is not defined&quot;</span></pre><p>Non-Zero exit code:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  exitcode: 1
&quot;&quot;&quot;</span>
<span class="Identifier">quit</span> <span class="StringLit">&quot;Non-Zero exit code&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">1</span></pre><p>Standard output checking:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  
  output: '''
0
1
2
3
4
5
'''

&quot;&quot;&quot;</span>
<span class="Keyword">for</span> <span class="Identifier">i</span> <span class="Keyword">in</span> <span class="FloatNumber">0.</span><span class="Operator">.</span><span class="DecNumber">5</span><span class="Punctuation">:</span> <span class="Identifier">echo</span> <span class="Identifier">i</span></pre><p>JavaScript tests:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  target: &quot;js&quot;
&quot;&quot;&quot;</span>
<span class="Keyword">when</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">js</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Keyword">import</span> <span class="Identifier">jsconsole</span>
  <span class="Identifier">console</span><span class="Operator">.</span><span class="Identifier">log</span><span class="Punctuation">(</span><span class="StringLit">&quot;My Frontend Project&quot;</span><span class="Punctuation">)</span></pre><p>Compile time tests:</p>
<pre class="listing"><span class="Keyword">discard</span> <span class="LongStringLit">&quot;&quot;&quot;
  action: &quot;compile&quot;
&quot;&quot;&quot;</span>
<span class="Keyword">static</span><span class="Punctuation">:</span> <span class="Identifier">assert</span> <span class="DecNumber">9</span> <span class="Operator">==</span> <span class="DecNumber">9</span><span class="Punctuation">,</span> <span class="StringLit">&quot;Compile time assert&quot;</span></pre><p>Tests without Spec:</p>
<pre class="listing"><span class="Identifier">assert</span> <span class="DecNumber">1</span> <span class="Operator">==</span> <span class="DecNumber">1</span></pre><p>See also:</p>
<ul class="simple"><li><a class="reference external" href="unittest.html">Unittest</a></li>
</ul>



    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-10-23 01:32:26 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
